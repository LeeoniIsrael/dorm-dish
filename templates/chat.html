<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dorm Dish</title>
    <link rel="stylesheet" href="/static/style/chat.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>dorm dish.</h1>
            <nav>
                <ul>
                    <li><a href="/landing.html">home</a></li>
                    <li><a href="/recipe.html">recipes</a></li>
                </ul>
            </nav>
        </header>
    </div>
    <div class="chat-container">
        <div class="chat-messages" id="chatMessages"></div>
        <form id="chatForm">
            <input type="text" id="userInput" placeholder="What's in your fridge?" required>
            <button type="submit">find recipe</button>
        </form>
    </div>
    <script>
        document.getElementById('chatForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const userInput = document.getElementById('userInput').value;
            
            // Add user message to chat
            const userMessage = document.createElement('div');
            userMessage.className = 'user-message';
            userMessage.textContent = userInput;
            document.getElementById('chatMessages').appendChild(userMessage);
            document.getElementById('userInput').value = '';

            // Scroll to the bottom of the chat messages
            document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;

            // Fetch recipes using AJAX
            $.ajax({
                url: '/get_recipes',
                type: 'POST',
                data: { ingredients: userInput },
                success: function(data) {
                    var recipesHtml = '<div class="bot-message"><h2>Recipes:</h2>';
                    $.each(data.recipes, function(index, recipe) {
                        recipesHtml += '<div>';
                        recipesHtml += '<h3>' + recipe.name + '</h3>';
                        recipesHtml += '<h4>Ingredients:</h4>';
                        recipesHtml += '<ul>';
                        $.each(recipe.ingredients, function(i, ingredient) {
                            recipesHtml += '<li>' + ingredient + '</li>';
                        });
                        recipesHtml += '</ul>';
                        recipesHtml += '</div>';
                    });
                    recipesHtml += '</div>';
                    $('#chatMessages').append(recipesHtml);
                    document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
                }
            });
        });
    </script>
</body>
</html>